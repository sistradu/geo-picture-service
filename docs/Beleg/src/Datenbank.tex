\section{Datenbank}
\label{JumpDatenbank}
\subsection{Aufbau der Datenbank}
Der wir nur 3 Klassen besitzen, fiel auch der Aufbau der Datenbank entsprechend einfach aus. Zunächst wurde für jede Klasse eine neue Collection angelegt, was etwas einer Tabelle in einer relationalen Datenbank oder einem Ordner in einem Dateisystem entspricht. In diesen Collections können nun ein, oder mehrere XML-Files gespeichert werden. Wie wir in \autoref{JumpDBOneBIGManysmall} begründet haben, speichern wir hier nur jeweils eine Datei.
Zusätzlich wurde noch eine Collection angelegt für unsere Stored XQuerys. In dieser sind mehrere .xql-Dateien hinterlegt, für alle Abfragen, die durchgeführt werden müssen:
\begin{itemize}
	\item exist/rest/db/
	\begin{itemize}
		\item nutzer/nutzers.xml
		\item alben/alben.xml
		\item bilder/bilder.xml
		\item queries/
		\begin{itemize}
			\item allNutzer.xql
			\item albenForNutzer.xql
			\item[] ...
			\item bilderForAlbum.xql
		\end{itemize}
	\end{itemize}
\end{itemize}
Für den Aufbau der einzelnen XML-Dateien sind im Anhang Beispiele unter \autoref{JumpListingNutzerXML}, \autoref{JumpListingAlbumXML} und \autoref{JumpListingBildXML} zu finden.
\subsection{Mockklassen}
Da die Datenbank noch nicht zu Beginn der Implementierungsphase komplett einsatzfähig war, musste eine Zwischenlösung her, damit bereits einfache Funktionalitäten getestet werden konnten. Die Idee war es Mockklassen zu verwenden. Dazu wurden zunächst Interfaces für alle sogenannten Konnektor-Klassen angelegt. Die Mockklassen zu den einzelnen Interfaces implementieren bereits einen großen Teil dieser Funktionen, ohne dabei im Hintergrund mit der Datenbank zu kommunizieren. Demnach bieten die Mockklassen auch nur eine eingeschränkte Funktionalität, wie die Rückgabe eines Benutzers zu einer ID oder die Suche nach bestimmten Alben, basierend auf einer Menge von Testdaten. Eintragen, Löschen oder Modifizieren dieser Daten ist mit den Mockklassen dabei nicht möglich.\\
Wird nun eine solche Klasse erzeugt, werden die Testdaten automatisch generiert und können genutzt werden. Später kann die jeweilige Mockklasse einfach mit der 'echten' Implementierung ausgetauscht werden. 
Ein Beispiel einer solchen Mockklasse, in dem Fall der MockAlbumConnector, ist im Anhang unter \autoref{JumpListingMockAlbumConnector} angegeben. Der Einfachheit halber werden nur die wichtigsten Methoden dargestellt.
\subsection{Datensicherheit}
%\begin{figwindow}[1, r, \includegraphics[width=0.35\textwidth]{img/Zugriffrechteverwaltung-eXist.png}, {Sperrung von Zugriffsrechten in eXist %\label{JumpFigureZugriffsrechteeXist}}]
Die Datensicherheit zu gewährleisten funkioniert unter eXist sehr einfach. Durch die einfache Zugriffsrechteverwaltung für Collections und einzelnen Dateien, können diese für öffentliche Nutzer schnell und einfach gesperrt werden. Nun müssen wir aber noch unserer Applikation vor einer Anfrage mitteilen, wie sich diese zu authentifizieren hat. Sonst würde diese sich als Gast anmelden und somit keine Zugriffsrechte besitzen. Das kann einfach umgesetzt werden, indem wir die Klasse java.net.Authenticator erweitern, dargestellt in \autoref{JumpListingAuthenticator}.
%\end{figwindow}
\begin{lstlisting}[caption=Erweiterung der Klasse Authenticator,label=JumpListingAuthenticator]
public class ExistAuthentificator extends Authenticator {
    protected PasswordAuthentication getPasswordAuthentication(){
        String promptString = getRequestingPrompt();
        String hostname = getRequestingHost();
        InetAddress ipaddr = getRequestingSite();
        int port = getRequestingPort();
        String username = USERNAME;
        String password = PASSWORD;
        return new PasswordAuthentication(username, password.toCharArray());
    }
}
\end{lstlisting}
Vor einer Anfrage muss nun einfach der Authenticator gesetzt werden:
\begin{lstlisting}
Authenticator.setDefault(new ExistAuthentificator());
\end{lstlisting}
Damit kann unser System problemlos auf die Datenbank zugreifen, während nicht authorisierte Nutzer dazu nicht in der Lage sind.
\subsection{Stored XQueries}

\subsection{Zugriff auf die Datenbank}

\subsection{Verhinderung gleichzeitiger Zugriffe}